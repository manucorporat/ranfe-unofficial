{"code":"import * as tslib_1 from \"tslib\";\r\nimport { getParameterByName, setDOMValues } from './utils';\r\nimport { weather } from './weather';\r\nimport { search } from './search';\r\nexport function setupResults() {\r\n    var origin = getParameterByName('origin').trim().toLowerCase();\r\n    var destination = getParameterByName('destination').trim().toLowerCase();\r\n    setupDOM(origin, destination);\r\n    setupWeather(origin, destination);\r\n    setupSearch(origin, destination);\r\n}\r\nfunction setupDOM(origin, destination) {\r\n    setDOMValues('#title-origin', 'textContent', origin);\r\n    setDOMValues('#title-destination', 'textContent', destination);\r\n    setDOMValues('input[name=origin]', 'value', origin);\r\n    setDOMValues('input[name=destination]', 'value', destination);\r\n}\r\nfunction setupWeather(origin, destination) {\r\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n        return tslib_1.__generator(this, function (_a) {\r\n            Promise.all([\r\n                weather.todayForecast(normalizeCity(destination)),\r\n                weather.todayForecast(normalizeCity(origin))\r\n            ]).then(function (weather) {\r\n                updateWeatherWidget('weather-container', destination, weather[0]);\r\n                updateWeatherWidget('weather-container', origin, weather[1]);\r\n            }).catch(function () {\r\n                console.log('weather city not found');\r\n            });\r\n            return [2 /*return*/];\r\n        });\r\n    });\r\n}\r\nfunction normalizeCity(city) {\r\n    return city + ', Spain';\r\n}\r\nfunction setupSearch(origin, destination) {\r\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n        var resultsTable, results, _i, results_1, item, el, e_1, noTrains;\r\n        return tslib_1.__generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    resultsTable = document.getElementById('table-data');\r\n                    if (!resultsTable) {\r\n                        return [2 /*return*/];\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, 3, , 4]);\r\n                    return [4 /*yield*/, search.search(origin, destination)];\r\n                case 2:\r\n                    results = _a.sent();\r\n                    for (_i = 0, results_1 = results; _i < results_1.length; _i++) {\r\n                        item = results_1[_i];\r\n                        el = document.createElement('tr');\r\n                        el.innerHTML = \"\\n      <td>\" + item.start + \"</td>\\n      <td>\" + item.end + \"</td>\\n      <td>\" + item.duration + \"</td>\\n      <td>\" + item.train + \"</td>\\n      <td>\" + item.type + \"</td>\\n      <td>\" + item.price + \"</td>\\n      \";\r\n                        resultsTable.appendChild(el);\r\n                    }\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    e_1 = _a.sent();\r\n                    noTrains = document.getElementById('no-trains');\r\n                    if (noTrains) {\r\n                        noTrains.classList.add('show');\r\n                        return [2 /*return*/];\r\n                    }\r\n                    return [3 /*break*/, 4];\r\n                case 4: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction updateWeatherWidget(id, city, forecast) {\r\n    var containerEl = document.getElementById(id);\r\n    if (!containerEl) {\r\n        return;\r\n    }\r\n    var el = document.createElement('div');\r\n    var temperature = forecast.Temperature.Metric.Value;\r\n    var text = forecast.WeatherText;\r\n    var iconHTML = getIcon(forecast);\r\n    el.classList.add('weather-content');\r\n    el.innerHTML = \"\\n  <h4>\" + city + \"</h4>\\n  <h3>\" + iconHTML + \" \" + temperature + \"\\u00BAC</h3>\\n  \";\r\n    containerEl.appendChild(el);\r\n}\r\nfunction getIcon(forecast) {\r\n    var icon = forecast.WeatherIcon;\r\n    var iconName = 'fa-sun-o';\r\n    switch (icon) {\r\n        case 6:\r\n        case 7:\r\n        case 8:\r\n        case 9:\r\n        case 10:\r\n        case 11:\r\n        case 38:\r\n            iconName = 'fa-cloud';\r\n            break;\r\n        case 12:\r\n        case 13:\r\n        case 14:\r\n        case 18:\r\n        case 39:\r\n        case 40:\r\n            iconName = 'fa-tint';\r\n            break;\r\n        case 15:\r\n        case 16:\r\n        case 17:\r\n        case 41:\r\n        case 42:\r\n            iconName = 'fa-bolt';\r\n            break;\r\n        case 19:\r\n        case 20:\r\n        case 21:\r\n        case 22:\r\n        case 23:\r\n        case 24:\r\n        case 25:\r\n        case 26:\r\n        case 27:\r\n        case 28:\r\n        case 29:\r\n        case 43:\r\n        case 44:\r\n            iconName = 'fa-snowflake-o';\r\n            break;\r\n        case 33:\r\n        case 34:\r\n        case 35:\r\n        case 36:\r\n        case 37:\r\n            iconName = 'fa-moon-o';\r\n            break;\r\n    }\r\n    return \"<i class=\\\"fa \" + iconName + \"\\\" aria-hidden=\\\"true\\\"></i>\";\r\n}\r\n//# sourceMappingURL=setup-results.js.map","map":{"version":3,"file":"setup-results.js","sourceRoot":"","sources":["../src/js/setup-results.ts"],"names":[],"mappings":"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"}}
