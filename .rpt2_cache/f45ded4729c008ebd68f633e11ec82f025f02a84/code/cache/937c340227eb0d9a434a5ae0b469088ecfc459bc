{"code":"import * as tslib_1 from \"tslib\";\r\nimport { http } from './http';\r\nvar WeatherService = /** @class */ (function () {\r\n    function WeatherService(apiKey) {\r\n        this.apiKey = apiKey;\r\n    }\r\n    WeatherService.prototype.request = function (query) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var url, response, result;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        url = \"http://apidev.accuweather.com/\" + query + \"&apiKey=\" + this.apiKey;\r\n                        return [4 /*yield*/, http.GET(url)];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        if (response.length > 0) {\r\n                            result = response[0];\r\n                            if (typeof result !== 'object') {\r\n                                throw new Error('response is not an object');\r\n                            }\r\n                            return [2 /*return*/, result];\r\n                        }\r\n                        else {\r\n                            throw new Error('empty response');\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    WeatherService.prototype.resolveCity = function (cityName) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var query, city, key;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        query = \"locations/v1/search?q=\" + cityName;\r\n                        return [4 /*yield*/, this.request(query)];\r\n                    case 1:\r\n                        city = _a.sent();\r\n                        key = city.Key;\r\n                        if (!key) {\r\n                            throw new Error('city key is null');\r\n                        }\r\n                        return [2 /*return*/, key];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    WeatherService.prototype.resolveForecast = function (key) {\r\n        var query = \"currentconditions/v1/\" + key + \".json?language=es\";\r\n        return this.request(query);\r\n    };\r\n    WeatherService.prototype.todayForecast = function (city) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var key;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.resolveCity(city)];\r\n                    case 1:\r\n                        key = _a.sent();\r\n                        return [2 /*return*/, this.resolveForecast(key)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return WeatherService;\r\n}());\r\nexport { WeatherService };\r\nexport var weather = new WeatherService('hoArfRosT1215');\r\n//# sourceMappingURL=weather.js.map","map":{"version":3,"file":"weather.js","sourceRoot":"","sources":["../src/js/weather.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAC;AAW9B;IAEE,wBACU,MAAc;QAAd,WAAM,GAAN,MAAM,CAAQ;IACpB,CAAC;IAES,gCAAO,GAArB,UAAsB,KAAa;;;;;;wBAC3B,GAAG,GAAG,mCAAiC,KAAK,gBAAW,IAAI,CAAC,MAAQ,CAAC;wBAC1D,qBAAM,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAA;;wBAA9B,QAAQ,GAAG,SAAmB;wBACpC,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;4BAClB,MAAM,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;4BAC3B,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC;gCAC/B,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;4BAC/C,CAAC;4BACD,MAAM,gBAAC,MAAM,EAAC;wBAChB,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACN,MAAM,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC;wBACpC,CAAC;;;;;KACF;IAEa,oCAAW,GAAzB,UAA0B,QAAgB;;;;;;wBAClC,KAAK,GAAG,2BAAyB,QAAU,CAAC;wBACrC,qBAAM,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,EAAA;;wBAAhC,IAAI,GAAG,SAAyB;wBAChC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;wBACrB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;4BACT,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;wBACtC,CAAC;wBACD,sBAAO,GAAG,EAAC;;;;KACZ;IAEO,wCAAe,GAAvB,UAAwB,GAAW;QACjC,IAAM,KAAK,GAAG,0BAAwB,GAAG,sBAAmB,CAAC;QAC7D,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAC7B,CAAC;IAEK,sCAAa,GAAnB,UAAoB,IAAY;;;;;4BAClB,qBAAM,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAA;;wBAAlC,GAAG,GAAG,SAA4B;wBACxC,sBAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAC;;;;KAClC;IACH,qBAAC;AAAD,CAAC,AAvCD,IAuCC;;AAED,MAAM,CAAC,IAAM,OAAO,GAAG,IAAI,cAAc,CAAC,eAAe,CAAC,CAAC"}}
